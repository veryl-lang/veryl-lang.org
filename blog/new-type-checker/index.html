<!DOCTYPE html>
<html lang="en">

<head prefix="og: http://ogp.me/ns#">
    <meta charset="UTF-8">
    <title>New Type Checker |  </title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <link rel="icon" type="image/png" href="/favicon.ico">
    
    <style>
    :root {
        /* Primary theme color */
        --primary-color: #2baa59;
        /* Primary theme text color */
        --primary-text-color: #543631;
        --primary-text-color-over: #000;
        /* Primary theme link color */
        --primary-link-color: #F9BB2D;
        /* Secondary color: the background body color */
        --secondary-color: #fcfaf6;
        --secondary-text-color: #303030;
        /* Highlight text color of table of content */
        --toc-highlight-text-color: #d46e13;
        --toc-background-color: white;

        --shadow-color: #ddd;

        /* Font used for headers (h1 & h2) */
        --header-font-family: "Fira Sans", sans-serif;
        /* Font used for text */
        --text-font-family: "Fira Sans", sans-serif;
    }

    @media (prefers-color-scheme: dark) {
        :root {
            --primary-color: #293831;
            --primary-text-color: #d7d7d7;
            --primary-text-color-over: #FFF;
            --primary-link-color: #9b9b9b;
            --secondary-color: #282828;
            --secondary-text-color: #f2f2f2;
            --toc-highlight-text-color: #f2f2f2;
            --toc-background-color: #3a3a3a;

            --shadow-color: #202020;
            --header-font-family: "Fira Sans", sans-serif;

            --text-font-family: "Fira Sans", sans-serif;

        }
    }
</style>

    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kumbh+Sans:wght@400;500&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="/normalize.css">
    <link rel="stylesheet" href="https://veryl-lang.org/juice.css">
    <!-- Juice references /normalize.css, which doesn't work, so we reference ./normalics.css here -->
    <link rel="shortcut icon" type="image/x-icon" href="/logo.png" />
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NXW2P6CCF3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'G-NXW2P6CCF3');
    </script>
    
<meta property="og:url" content="https://veryl-lang.org/blog/new-type-checker/" />
<meta property="og:title" content="New Type Checker" />
<meta property="og:description" content="With the new type checker currently under development, it will become possible to perform …" />
<meta property="og:image" content="https://github.com/veryl-lang/veryl/raw/master/support/logo/veryl_ogp.png" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:domain" content="veryl-lang.org" />
<meta name="twitter:title" content="New Type Checker" />
<meta name="twitter:description" content="With the new type checker currently under development, it will become possible to perform …" />
<meta name="twitter:image" content="https://github.com/veryl-lang/veryl/raw/master/support/logo/veryl_ogp.png" />

</head>

<body>
    
<header class="box-shadow">
    

<a href="https://veryl-lang.org/">
    <div class="logo">
        <img src="https://veryl-lang.org/logo.png" alt="logo">
        
    </div>
</a>

<nav>
    
    
    
    <a class="nav-item subtitle-text" href="https://veryl-lang.org/install/">Install</a>
    
    
    
    
    <a class="nav-item subtitle-text" href="https://veryl-lang.org/docs/">Docs</a>
    
    
    
    
    <a class="nav-item subtitle-text" href="https://veryl-lang.org/statistics/">Statistics</a>
    
    
    
    
    <a class="nav-item subtitle-text" href="https://veryl-lang.org/blog/">Blog</a>
    
    
        
        <a class="nav-item subtitle-text" href="https://doc.veryl-lang.org/playground">Playground</a>
        
    
    
        
        <a class="nav-item subtitle-text" href="https://github.com/veryl-lang/veryl"><img src="https://veryl-lang.org/github-mark-white.png" alt="icon" height="20"></a>
        
        <a class="nav-item subtitle-text" href="https://discord.gg/MJZr9NufTT"><img src="https://veryl-lang.org/Discord-Symbol-White.png" alt="icon" height="20"></a>
        
    
</nav>

</header>


    <main>
        




        <div class="content text">
            
<div class="heading-text">New Type Checker</div>
<p>With the new type checker currently under development, it will become possible to perform various type checks that were previously impossible.
As an initial implementation, the following checks are scheduled to be introduced in the next version:</p>
<ul>
<li>Mismatch in array dimensions during assignment</li>
<li>Assigning a 4-state value to a 2-state type</li>
<li>Out-of-range selection for arrays or bits</li>
<li>Interface mismatch during port connection</li>
</ul>
<p>Furthermore, the Veryl compiler will track parameter overrides across all instances,
including those with recursion, ensuring that it can reliably catch issues that only occur with specific overrides.</p>
<p>For example,</p>
<pre data-lang="veryl" style="background-color:#393939;color:#dedede;" class="language-veryl "><code class="language-veryl" data-lang="veryl"><span style="color:#fed6af;">module </span><span>ModuleX #(
</span><span>    </span><span style="color:#fed6af;">param </span><span>A: </span><span style="color:#fffb9d;">u32</span><span> = 1,
</span><span>) {
</span><span>    </span><span style="color:#fed6af;">let </span><span>a : </span><span style="color:#fffb9d;">logic</span><span>&lt;2&gt; = 1;
</span><span>    </span><span style="color:#fed6af;">let </span><span>_b: </span><span style="color:#fffb9d;">logic</span><span>&lt;2&gt; = a[A]; </span><span style="color:#a0cfa1;">//</span><span style="color:#87ae86;"> This bit select causes out-of-range error when A &gt; 2
</span><span>}
</span><span>
</span><span style="color:#fed6af;">module </span><span>ModuleY #(
</span><span>    </span><span style="color:#fed6af;">param </span><span>A: </span><span style="color:#fffb9d;">u32</span><span> = 1,
</span><span>) {
</span><span>    </span><span style="color:#fed6af;">inst </span><span>u: ModuleX #(A,);
</span><span>}
</span><span>
</span><span style="color:#fed6af;">module </span><span>ModuleZ {
</span><span>    </span><span style="color:#fed6af;">inst </span><span>u: ModuleY #(A: 3,);
</span><span>}
</span></code></pre>
<p>it will display a warning as follows:</p>
<pre style="background-color:#393939;color:#dedede;"><code><span>Warning: invalid_select (https://doc.veryl-lang.org/book/07_appendix/02_semantic_error.html#invalid_select)
</span><span>
</span><span>  ⚠ invalid select caused by out of range [3:3] &gt; 2
</span><span>   ╭─[.../test.veryl:5:24]
</span><span> 4 │     let a : logic&lt;2&gt; = 1;
</span><span> 5 │     let _b: logic&lt;2&gt; = a[A]; // This bit select causes out-of-range error when A &gt; 2
</span><span>   ·                        ──┬─
</span><span>   ·                          ╰── Error location
</span><span> 6 │ }
</span><span>   ╰────
</span><span>    ╭─[.../test.veryl:11:10]
</span><span> 10 │ ) {
</span><span> 11 │     inst u: ModuleX #(A,);
</span><span>    ·          ┬
</span><span>    ·          ╰── instantiated at
</span><span> 12 │ }
</span><span>    ╰────
</span><span>    ╭─[.../test.veryl:15:10]
</span><span> 14 │ module ModuleZ {
</span><span> 15 │     inst u: ModuleY #(A: 3,);
</span><span>    ·          ┬
</span><span>    ·          ╰── instantiated at
</span><span> 16 │ }
</span><span>    ╰────
</span><span>  help:
</span></code></pre>
<p>We believe such warnings should ideally be treated as errors.
However, due to the potential for false positives caused by the type checker’s current imperfections,
they will remain warnings until the implementation stabilizes, with plans to upgrade them to errors in the future.</p>
<p>Checks related to bit-width, such as bit-width mismatches during assignment or carry overflow in operations, are ready for implementation.
However, we are still deliberating on the policy regarding which checks should be performed.
Those interested in this issue are encouraged to refer to <a href="https://github.com/veryl-lang/veryl/issues/1257">the Issue page</a>.</p>
<p>The next version, which includes these features, may introduce breaking changes due to significant updates to the checking functionality and is planned to be v0.14.0.
It is scheduled for release within 1-2 weeks, so please look forward to it.</p>


        </div>

        
        
    </main>

    
    <footer>
    </footer>
    
</body>
<script>
    const scrollHandler = entries => {
        // Find the first entry which intersecting and ratio > 0.9 to highlight.
        let entry = entries.find(entry => {
            return entry.isIntersecting && entry.intersectionRatio > 0.9;
        });
        if (!entry) return;

        document.querySelectorAll(".toc a").forEach((item) => {
            item.classList.remove("active");
        });

        // let url = new URL(`#${entry.target.id}`);
        let link = document.querySelector(`.toc a[href$="${decodeURIComponent(`#${entry.target.id}`)}"]`)
        if (link) {
            link.classList.add("active");
            link.scrollIntoView({ behavior: "auto", block: "nearest" });
        }
    };
    // Set -100px root margin to improve highlight experience.
    const observer = new IntersectionObserver(scrollHandler, { threshold: 1 });
    let items = document.querySelectorAll('h1,h2,h3,h4,h5,h6');
    items.forEach(item => observer.observe(item));
</script>

</html>
